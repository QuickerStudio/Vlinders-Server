# Vlinders-Server è§„èŒƒæ–‡æ¡£æ€»è§ˆ

**ç‰ˆæœ¬**: v1.0
**æœ€åæ›´æ–°**: 2026-02-28
**çŠ¶æ€**: ğŸ“ è®¾è®¡å®Œæˆ

---

## ğŸ“‹ æ–‡æ¡£å¯¼èˆª

æœ¬ç›®å½•åŒ…å« Vlinders-Server çš„å®Œæ•´è§„èŒƒæ–‡æ¡£ï¼Œæ¶µç›–æ¶æ„è®¾è®¡ã€æŠ€æœ¯é€‰å‹ã€å®æ–½æ–¹æ¡ˆç­‰ã€‚

### æ ¸å¿ƒæ–‡æ¡£

1. **[æ¶æ„è®¾è®¡](./01-æ¶æ„è®¾è®¡.md)** ğŸ—ï¸
   - æ•´ä½“æ¶æ„å›¾
   - åˆ†å±‚è®¾è®¡
   - æ ¸å¿ƒç»„ä»¶
   - æ•°æ®æµè®¾è®¡
   - æ‰©å±•æ€§è®¾è®¡

2. **[æŠ€æœ¯é€‰å‹](./02-æŠ€æœ¯é€‰å‹.md)** ğŸ”§
   - vLLM vs TGI vs å…¶ä»–
   - FastAPI vs Flask vs Django
   - Tree-sitter vs LSP
   - Qdrant vs Pinecone vs Milvus
   - å®Œæ•´æŠ€æœ¯æ ˆå¯¹æ¯”

3. **[vLLM é›†æˆæ–¹æ¡ˆ](./03-vLLMé›†æˆæ–¹æ¡ˆ.md)** ğŸš€
   - vLLM ç®€ä»‹å’Œä¼˜åŠ¿
   - å®‰è£…å’Œé…ç½®
   - æ¨¡å‹åŠ è½½
   - æ¨ç†æ¥å£
   - æ€§èƒ½ä¼˜åŒ–
   - ç”Ÿäº§éƒ¨ç½²

---

## ğŸ¯ Vlinders-Server å®šä½

### æ ¸å¿ƒå®šä½

> **æ¨ç†å±‚ + Agent ç¼–æ’å¼•æ“**
>
> åŸºäº vLLM çš„é«˜æ€§èƒ½å¤§æ¨¡å‹æ¨ç†æœåŠ¡ï¼Œè´Ÿè´£ AI æ ¸å¿ƒé€»è¾‘

### èŒè´£è¾¹ç•Œ

**è´Ÿè´£**:
- âœ… å¤§æ¨¡å‹æ¨ç†ï¼ˆvLLMï¼‰
- âœ… Agent ç¼–æ’å’Œç”Ÿå‘½å‘¨æœŸç®¡ç†
- âœ… å·¥å…·è°ƒç”¨å¾ªç¯
- âœ… ä»£ç åˆ†æå’Œç´¢å¼•
- âœ… å‘é‡æœç´¢å’Œè¯­ä¹‰åŒ¹é…
- âœ… ä¸Šä¸‹æ–‡ç®¡ç†å’Œå‹ç¼©

**ä¸è´Ÿè´£**:
- âŒ ç”¨æˆ·è®¤è¯å’Œæˆæƒï¼ˆç”± Vlinders-API å¤„ç†ï¼‰
- âŒ è®¢é˜…å’Œè®¡è´¹ï¼ˆç”± Vlinders-API å¤„ç†ï¼‰
- âŒ ç›´æ¥æš´éœ²ç»™ç”¨æˆ·ï¼ˆåªæ¥å—å†…éƒ¨è¯·æ±‚ï¼‰

---

## ğŸ—ï¸ æ¶æ„æ¦‚è§ˆ

### äº”å±‚æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Vlinders-Server                               â”‚
â”‚                                                                  â”‚
â”‚  1. API Gateway Layer      - FastAPI + gRPC                     â”‚
â”‚  2. Business Logic Layer   - Agent Orchestrator                 â”‚
â”‚  3. Service Layer          - vLLM + Tools + Code Analysis       â”‚
â”‚  4. Infrastructure Layer   - GPU + Sandbox + Tree-sitter        â”‚
â”‚  5. Data Layer             - Qdrant + PostgreSQL + Redis        â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### æ ¸å¿ƒç»„ä»¶

| ç»„ä»¶ | æŠ€æœ¯ | èŒè´£ |
|------|------|------|
| **æ¨ç†å¼•æ“** | vLLM | å¤§æ¨¡å‹æ¨ç† |
| **æ¨¡å‹è·¯ç”±** | vLLM Semantic Router | æ™ºèƒ½æ¨¡å‹é€‰æ‹© |
| **Web æ¡†æ¶** | FastAPI | HTTP API |
| **Agent ç¼–æ’** | è‡ªç ” | Agent ç”Ÿå‘½å‘¨æœŸç®¡ç† |
| **å·¥å…·æ‰§è¡Œ** | Docker Sandbox | å®‰å…¨æ‰§è¡Œå·¥å…· |
| **ä»£ç åˆ†æ** | Tree-sitter | è¯­æ³•è§£æ |
| **å‘é‡æœç´¢** | Qdrant | è¯­ä¹‰æœç´¢ |
| **ç¼“å­˜** | Redis | ç»“æœç¼“å­˜ |
| **æ•°æ®åº“** | PostgreSQL | å…ƒæ•°æ®å­˜å‚¨ |

---

## ğŸ”§ æŠ€æœ¯æ ˆ

### å®Œæ•´æŠ€æœ¯æ ˆ

```yaml
è¯­è¨€: Python 3.11+

æ ¸å¿ƒ:
  - vLLM (æ¨ç†å¼•æ“)
  - vLLM Semantic Router (æ™ºèƒ½æ¨¡å‹è·¯ç”±)
  - FastAPI (Web æ¡†æ¶)
  - Tree-sitter (ä»£ç è§£æ)
  - Qdrant (å‘é‡æ•°æ®åº“)

æ•°æ®:
  - PostgreSQL (å…³ç³»æ•°æ®)
  - Redis (ç¼“å­˜)
  - Qdrant (å‘é‡æ•°æ®)

åŸºç¡€è®¾æ–½:
  - Docker (å®¹å™¨åŒ–)
  - Kubernetes (ç¼–æ’)
  - Prometheus (ç›‘æ§)
  - Grafana (å¯è§†åŒ–)

GPU:
  - CUDA 12.1+
  - cuDNN 8.9+
  - NVIDIA A100/H100
```

---

## ğŸ“Š æ€§èƒ½ç›®æ ‡

### å…³é”®æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å½“å‰å€¼ |
|------|--------|--------|
| **é¦– Token å»¶è¿Ÿ (TTFT)** | < 500ms | - |
| **Token ç”Ÿæˆé€Ÿåº¦** | > 50 tokens/s | - |
| **å¹¶å‘è¯·æ±‚æ•°** | > 100 | - |
| **GPU åˆ©ç”¨ç‡** | > 80% | - |
| **æœåŠ¡å¯ç”¨æ€§** | > 99.5% | - |

### æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

1. **vLLM ä¼˜åŒ–**
   - PagedAttentionï¼ˆ24x ååé‡ï¼‰
   - Continuous Batching
   - å‰ç¼€ç¼“å­˜

2. **ç¼“å­˜ç­–ç•¥**
   - L1: å†…å­˜ç¼“å­˜
   - L2: Redis ç¼“å­˜
   - L3: æ•°æ®åº“

3. **å¹¶å‘å¤„ç†**
   - å¼‚æ­¥ I/O (asyncio)
   - è¿æ¥æ± 
   - æ‰¹å¤„ç†

---

## ğŸš€ å®æ–½è®¡åˆ’

### Phase 1: åŸºç¡€è®¾æ–½ï¼ˆWeek 1-2ï¼‰

**ç›®æ ‡**: æ­å»ºåŸºç¡€æ¡†æ¶

- [ ] åˆ›å»º Vlinders-Server ä»“åº“
- [ ] æ­å»º Python é¡¹ç›®ç»“æ„
- [ ] é…ç½® vLLM ç¯å¢ƒ
- [ ] åŠ è½½ç¬¬ä¸€ä¸ªæ¨¡å‹ï¼ˆLlama 3 8Bï¼‰
- [ ] å®ç°åŸºç¡€æ¨ç†æ¥å£
- [ ] å®ç°å¥åº·æ£€æŸ¥ç«¯ç‚¹

**äº¤ä»˜ç‰©**:
- å¯è¿è¡Œçš„ vLLM æ¨ç†æœåŠ¡
- åŸºç¡€ HTTP API
- Docker é•œåƒ

---

### Phase 2: Agent ç¼–æ’ï¼ˆWeek 3-4ï¼‰

**ç›®æ ‡**: å®ç° Agent æ ¸å¿ƒé€»è¾‘

- [ ] å®ç° Agent ç¼–æ’å™¨
- [ ] å®ç°å·¥å…·è°ƒç”¨å¾ªç¯
- [ ] å®ç°åŸºç¡€å·¥å…·ï¼ˆä»£ç æœç´¢ã€æ–‡ä»¶è¯»å–ï¼‰
- [ ] å®ç°ä¸Šä¸‹æ–‡ç®¡ç†
- [ ] æµ‹è¯•å¤šè½®å¯¹è¯

**äº¤ä»˜ç‰©**:
- Agent ç¼–æ’å¼•æ“
- å·¥å…·æ‰§è¡Œå™¨
- ä¸Šä¸‹æ–‡ç®¡ç†å™¨

---

### Phase 3: ä»£ç åˆ†æï¼ˆWeek 5-6ï¼‰

**ç›®æ ‡**: å®ç°ä»£ç åˆ†æèƒ½åŠ›

- [ ] é›†æˆ Tree-sitter
- [ ] å®ç°ä»£ç è§£æ
- [ ] å®ç°ç¬¦å·æå–
- [ ] é›†æˆ Qdrant
- [ ] å®ç°è¯­ä¹‰æœç´¢

**äº¤ä»˜ç‰©**:
- ä»£ç åˆ†æå¼•æ“
- å‘é‡æœç´¢æœåŠ¡
- ä»£ç ç´¢å¼•å™¨

---

### Phase 4: é«˜çº§åŠŸèƒ½ï¼ˆWeek 7-8ï¼‰

**ç›®æ ‡**: å®ç°é«˜çº§ Agent åŠŸèƒ½

- [ ] å®ç°å­ Agent å¹¶è¡Œæ‰§è¡Œ
- [ ] å®ç°åå°å‹ç¼©
- [ ] å®ç° Memory æœåŠ¡
- [ ] ä¼˜åŒ–æ€§èƒ½

**äº¤ä»˜ç‰©**:
- å®Œæ•´çš„ Agent ç³»ç»Ÿ
- æ€§èƒ½ä¼˜åŒ–ç‰ˆæœ¬
- ç›‘æ§å’Œæ—¥å¿—

---

### Phase 5: ç”Ÿäº§éƒ¨ç½²ï¼ˆWeek 9-10ï¼‰

**ç›®æ ‡**: ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

- [ ] Kubernetes éƒ¨ç½²
- [ ] ç›‘æ§å’Œå‘Šè­¦
- [ ] æ€§èƒ½æµ‹è¯•
- [ ] æ–‡æ¡£å®Œå–„

**äº¤ä»˜ç‰©**:
- ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- ç›‘æ§ä»ªè¡¨æ¿
- å®Œæ•´æ–‡æ¡£

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
Vlinders-Server/
â”œâ”€â”€ README.md                          # é¡¹ç›®è¯´æ˜
â”œâ”€â”€ Spec/                              # è§„èŒƒæ–‡æ¡£ï¼ˆæœ¬ç›®å½•ï¼‰
â”‚   â”œâ”€â”€ README.md                      # æœ¬æ–‡ä»¶
â”‚   â”œâ”€â”€ 01-æ¶æ„è®¾è®¡.md
â”‚   â”œâ”€â”€ 02-æŠ€æœ¯é€‰å‹.md
â”‚   â””â”€â”€ 03-vLLMé›†æˆæ–¹æ¡ˆ.md
â”‚
â”œâ”€â”€ vlinders_server/                   # ä¸»ä»£ç ç›®å½•
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py                        # å…¥å£æ–‡ä»¶
â”‚   â”œâ”€â”€ config.py                      # é…ç½®ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ api/                           # API å±‚
â”‚   â”‚   â”œâ”€â”€ internal.py                # å†…éƒ¨ API
â”‚   â”‚   â””â”€â”€ health.py                  # å¥åº·æ£€æŸ¥
â”‚   â”‚
â”‚   â”œâ”€â”€ inference/                     # æ¨ç†å±‚
â”‚   â”‚   â”œâ”€â”€ vllm_service.py            # vLLM æœåŠ¡
â”‚   â”‚   â””â”€â”€ model_manager.py           # æ¨¡å‹ç®¡ç†
â”‚   â”‚
â”‚   â”œâ”€â”€ agent/                         # Agent å±‚
â”‚   â”‚   â”œâ”€â”€ orchestrator.py            # ç¼–æ’å™¨
â”‚   â”‚   â””â”€â”€ tool_calling_loop.py       # å·¥å…·è°ƒç”¨å¾ªç¯
â”‚   â”‚
â”‚   â”œâ”€â”€ tools/                         # å·¥å…·å±‚
â”‚   â”‚   â”œâ”€â”€ executor.py                # æ‰§è¡Œå™¨
â”‚   â”‚   â””â”€â”€ builtin/                   # å†…ç½®å·¥å…·
â”‚   â”‚
â”‚   â”œâ”€â”€ code_analysis/                 # ä»£ç åˆ†æå±‚
â”‚   â”‚   â”œâ”€â”€ parser.py                  # Tree-sitter
â”‚   â”‚   â””â”€â”€ embeddings.py              # åµŒå…¥ç”Ÿæˆ
â”‚   â”‚
â”‚   â”œâ”€â”€ context/                       # ä¸Šä¸‹æ–‡ç®¡ç†å±‚
â”‚   â”‚   â”œâ”€â”€ manager.py                 # ç®¡ç†å™¨
â”‚   â”‚   â””â”€â”€ compressor.py              # å‹ç¼©å™¨
â”‚   â”‚
â”‚   â””â”€â”€ knowledge/                     # çŸ¥è¯†åº“å±‚
â”‚       â”œâ”€â”€ vector_store.py            # å‘é‡å­˜å‚¨
â”‚       â””â”€â”€ indexer.py                 # ç´¢å¼•å™¨
â”‚
â”œâ”€â”€ tests/                             # æµ‹è¯•
â”œâ”€â”€ scripts/                           # è„šæœ¬
â”œâ”€â”€ configs/                           # é…ç½®
â”œâ”€â”€ docker-compose.yml                 # Docker ç¼–æ’
â””â”€â”€ Dockerfile                         # Docker é•œåƒ
```

---

## ğŸ”— ä¸å…¶ä»–ç»„ä»¶çš„å…³ç³»

### ä¸ Vlinders-API çš„æ¥å£

**é€šä¿¡åè®®**: HTTP/gRPC (å†…éƒ¨)

**è®¤è¯**: å†…éƒ¨å¯†é’¥ (X-Internal-Auth)

**ä¸»è¦ç«¯ç‚¹**:
```
POST /internal/chat              # èŠå¤©æ¨ç†
POST /internal/agent             # Agent æ‰§è¡Œ
POST /internal/tools/execute     # å·¥å…·æ‰§è¡Œ
POST /internal/embeddings        # æ–‡æœ¬åµŒå…¥
```

### ä¸ Vlinder-chat çš„å…³ç³»

**æ— ç›´æ¥é€šä¿¡** - æ‰€æœ‰è¯·æ±‚é€šè¿‡ Vlinders-API è½¬å‘

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

### é¡¹ç›®æ–‡æ¡£
- [é¡¹ç›®æ€»ä½“è§„åˆ’](../../é¡¹ç›®æ€»ä½“è§„åˆ’.md)
- [è¾¹ç•Œæ˜ç¡®æ–‡æ¡£](../../Vlinders-API/è¾¹ç•Œæ˜ç¡®æ–‡æ¡£.md)
- [Vlinders-API è§„èŒƒ](../../Vlinders-API/Spec/)

### å¤–éƒ¨æ–‡æ¡£
- [vLLM å®˜æ–¹æ–‡æ¡£](https://docs.vllm.ai/)
- [FastAPI æ–‡æ¡£](https://fastapi.tiangolo.com/)
- [Tree-sitter æ–‡æ¡£](https://tree-sitter.github.io/)
- [Qdrant æ–‡æ¡£](https://qdrant.tech/documentation/)

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

### å¼€å‘æµç¨‹

1. Fork ä»“åº“
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯
3. ç¼–å†™ä»£ç å’Œæµ‹è¯•
4. æäº¤ Pull Request

### ä»£ç è§„èŒƒ

- ä½¿ç”¨ Black æ ¼å¼åŒ–ä»£ç 
- ä½¿ç”¨ Ruff è¿›è¡Œ Lint
- ä½¿ç”¨ mypy è¿›è¡Œç±»å‹æ£€æŸ¥
- ç¼–å†™å•å…ƒæµ‹è¯•ï¼ˆè¦†ç›–ç‡ > 80%ï¼‰

---

## ğŸ“ è”ç³»æ–¹å¼

- **GitHub**: https://github.com/QuickerStudio/Vlinders-Server
- **Discord**: https://discord.gg/vlinders
- **é‚®ç®±**: team@vlinders.org

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### 2026-02-28
- âœ… åˆ›å»ºæ¶æ„è®¾è®¡æ–‡æ¡£
- âœ… åˆ›å»ºæŠ€æœ¯é€‰å‹æ–‡æ¡£
- âœ… åˆ›å»º vLLM é›†æˆæ–¹æ¡ˆæ–‡æ¡£
- âœ… åˆ›å»ºè§„èŒƒæ€»è§ˆæ–‡æ¡£

---

**çŠ¶æ€**: ğŸ“ è§„èŒƒå®Œæˆï¼Œå‡†å¤‡å®æ–½
**ä¸‹ä¸€æ­¥**: åˆ›å»º Vlinders-Server ä»“åº“å¹¶å¼€å§‹å¼€å‘
